<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="fontawesome-free-5.15.2-web/css/all.css">
	<!--Custom CSS -->
	<link rel="stylesheet" href="css/style.css">
	<title>Admin-Fight COVID</title>
</head>

<body style="display: flex; min-height: 100vh; flex-direction: column;">

	<header>

		<div id="pageHeader">
			<div class="container-fluid">
				<nav class="navbar navbar-light navbar-expand-md" style="background-color:#68a8d3;">
					<a class="navbar-brand" href="">
						<img src="images/stopcovid.jpg" width="50px" alt="">
					</a>
					<button data-toggle="collapse" data-target="#navbarToggler" type="button"
						class="navbar-toggler"><span class="navbar-toggler-icon"></span></button>
					<div class="collapse navbar-collapse" id="navbarToggler">
						<ul class="navbar-nav">
							<li class="nav-item active">
								<a class="nav-link" href="/index"><i class="fas fa-home"></i>Home</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="/news">News</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="/aboutus">About us</a>
							</li>
							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button"
									href="#">Registration</a>

								<div class="dropdown-menu">
									<a class="dropdown-item" href="/user_reg">Patient registration</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" href="/doctor_reg">Doctor registration</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" href="/nurse_reg">Nurse registration</a>
								</div>

							</li>

						</ul>

						<div class="navbar-collapse">
							<ul class="navbar-nav ml-auto">
								<li class="nav-item">
									<a class="nav-link" href="/login"><i class="fas fa-sign-in-alt"></i>Logout</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" href="/admin"><i class="fas fa-user"></i>Admin</a>
								</li>
							</ul>
						</div>
					</div>
				</nav>

			</div>
		</div>

	</header>
	<!-- End of Header-->

	<div class="table-responsive" style="flex: 1; margin-left: 1%; margin-right: 1%;">
		<br>
		<h4>Patient List</h4>

		<br>
		<table id="patients" class="table table-striped table-primary"></table>

		<button id="remove-patients" type="button" class="btn btn-primary">Remove</button>
	</div>

	<footer style="background-color: #6c7d8b;">
		<div class="container top-footer p-md-3 p-1">
			<div class="row">
				<div class="col-md-3 pl-4 pr-4">
					<h5>Social Media</h5>
					<a style="color:silver;" href="https://www.facebook.com/coronavirus_info/"><i
							class="fab fa-2x fa-facebook-square"></i></a>
					<a style="color: silver;" href="https://twitter.com/infocovid_19?lang=en"><i
							class="fab fa-2x fa-twitter-square"></i></a>
					<a style="color: silver;" href="https://www.instagram.com/cdcgov/?hl=en"><i
							class="fab fa-2x fa-instagram"></i></a>
				</div>

				<div class="col-md-3  pl-4 pr-4">
					<h5>Important Links</h5>
					<a href="#">Privacy Policy</a><br>
					<a href="https://www.worldometers.info/coronavirus/">COVID cases across Globe </a><br>
					<a
						href="https://santemontreal.qc.ca/en/public/coronavirus-covid-19/situation-of-the-coronavirus-covid-19-in-montreal/">Montreal
						Active-cases </a><br>
				</div>

				<div class="col-md-3  pl-4 pr-4">
					<h5>Our Services</h5>
					<a href="#">COVID Testing </a><br>
					<a href="#">COVID Treatment</a><br>
				</div>

				<div class="col-md-3  pl-4 pr-4">
					<h5>Contact Us</h5>
					<a href="#"><i class="fas fa-phone"></i> +1 438-622-1234 </a><br>
					<a href="#"><i class="fas fa-envelope"></i> help@fightcovid.com </a><br>


				</div>
			</div>
		</div>
		<div class="container-fluid bottom-footer pt-2">
			<div class="row">
				<div class="col-12 text-center">
					<p>Copyrights Â© 2021 - All rights reserved</p>
				</div>
			</div>
		</div>

	</footer>

	<!-- JavaScript -->
	<script>
		// show patients
		getapi('/patients').then(
			registerPatientButtonEvents
		);

		// Defining async function
		async function getapi(url) {

			// Storing response
			const response = await fetch(url);

			// Storing data in form of JSON
			var data = await response.json();
			console.log(data);
			show(data);
		}

		// Function to define innerHTML for HTML table
		function show(data) {
			let tab =
				`<tr>
	<th></th>
	<th>ID</th>
	<th>Name</th>
	<th>Phone</th>
	<th>Address</th>
	<th>Date Of Birth</th>
	<th>Email</th>
	</tr>`;


			// Loop to access all rows
			for (let patient of data) {
				tab += `<tr>
		<td><input class="checkbox" type="checkbox" name="patient-checkbox" id="${patient.patientID}"></td>
		<td>${patient.patientID} </td>
		<td>${patient.patientName}</td>
		<td>${patient.phone}</td>
		<td>${patient.address}</td>
		<td>${patient.dateOfBirth}</td>
		<td>${patient.email}</td>
		</tr>`;
			}

			// Setting innerHTML as tab variable
			document.getElementById("patients").innerHTML = tab;
		}

		async function removePatients(url) {
			await fetch(url);
		}

		async function removePatientsAppointments(url) {
			await fetch(url);
		}

		function registerPatientButtonEvents() {
			document.getElementById("remove-patients").addEventListener("click", function () {
				let selectedPatientCheckboxes = document.querySelectorAll(`input[name="patient-checkbox"]:checked`);

				let requestString = '?patientIDList=';

				selectedPatientCheckboxes.forEach((checkbox) => {
					requestString += checkbox.id + ',';
				});

				removePatientsAppointments('/removePatientsAppointments' + requestString.slice(0, requestString.length - 1))

				removePatients('/removePatients' + requestString.slice(0, requestString.length - 1)).then(
					function () {
						getapi('/patients')
					}
				);
			});
		}
	</script>

	<!-- JavaScript -->
	<script src="bootstrap/js/jquery-3.3.1.slim.min.js"></script>
	<script src="bootstrap/js/popper.min.js"></script>
	<script src="bootstrap/js/bootstrap.min.js"></script>
</body>

</html>
